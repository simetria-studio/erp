$(document).ready((function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$("form").on("submit",(function(e){e.preventDefault(),$(this).find(".btn-modal-salvar").trigger("click")})),$("form").find("input").on("keyup",(function(e){13==e.keyCode&&$(this).find(".btn-modal-salvar").trigger("click")}));var Toast=Swal.mixin({toast:!0,position:"center",showConfirmButton:!1,timer:4e3});$(document).on("click",".btn-modal-salvar",(function(){let save_target=$(this).data("save_target"),save_route=$(this).data("save_route"),update_table=$(this).data("update_table"),table_tbody=$(this).data("tbody");var form_data=new FormData($(save_target)[0]),checkbox=$(save_target).find("input[type=checkbox]");$.each(checkbox,(function(key,val){form_data.append($(val).attr("name"),$(this).is(":checked"))})),$(save_target).find("input").removeClass("is-invalid"),$(save_target).find(".invalid-feedback").remove();let modal=$(save_target);modal.find("input, select").attr("readonly",!0),modal.find("button").attr("disabled",!0),$.ajax({url:save_route,type:"POST",data:form_data,cache:!1,contentType:!1,processData:!1,success:data=>{console.log(data),modal.find("input, select").attr("readonly",!1),modal.find("button").attr("disabled",!1),$(modal).parent().parent().parent().modal("hide"),$(save_target).find('input[type="text"]').val(""),"S"==update_table&&data.table&&$("table "+table_tbody).append(data.table),"S"==update_table&&data.tb_up&&$("table "+table_tbody).find(".tr-id-"+data.tb_id).html(data.tb_up),Toast.fire({icon:"success",title:"Os dados foram salvos com successo!"})},error:err=>{modal.find("input, select").attr("readonly",!1),modal.find("button").attr("disabled",!1);let erro_tags=err.responseJSON.errors;$.each(erro_tags,(key,value)=>{let tag=$(save_target).find('[name="'+key+'"]');tag.addClass("is-invalid"),tag.parent().append('<div class="invalid-feedback">'+value[0]+"</div>")}),err.responseJSON.msg_alert&&Swal.fire({icon:err.responseJSON.icon_alert,text:err.responseJSON.msg_alert})}})})),$(document).on("click",".btn-editar",(function(){var target=$(this).data("target"),dados=$(this).data("dados");$.each(dados,(key,value)=>{$(target).find('[name="'+key+'"').val(value),$(target).find("."+key).val(value),$(target).find("._"+key).text(value)}),$(target).find("input[type=checkbox]").each((function(){"true"==$(this).val()?$(this).prop("checked",!0):$(this).prop("checked",!1)}))})),$(document).on("click",".btn-apagar",(function(e){var dados=$(this).data("dados"),route=$(this).data("route"),table_tbody=$(this).data("tbody");Swal.fire({icon:"info",title:"Apagar Item",text:"Tem certeza que gostatia de apagar esse item?",showCancelButton:!0,confirmButtonText:"SIM",cancelButtonText:"NÃƒO",showLoaderOnConfirm:!0,preConfirm:destroy=>$.ajax({url:route,type:"DELETE",data:dados}).then(response=>(console.log(response),$("table "+table_tbody).find(".tr-id-"+response).remove(),Toast.fire({icon:"success",title:"Os dados foram salvos com successo!"}),response)).catch(error=>{Swal.showValidationMessage(error.responseJSON)})})}))}));